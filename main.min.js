angular.module("forum.core",["ngRoute","ui.router","textAngular","ngCookies","angular-loading-bar","ui.bootstrap","yaru22.angular-timeago","oc.lazyLoad","angularFileUpload","pascalprecht.translate","smart-table"]),angular.module("global.directives",[]),angular.module("global.config",[]),angular.module("global.factories",[]),angular.module("global.controllers",[]),angular.module("forum.global",["global.config","global.directives","global.factories","global.controllers"]),angular.module("home.controllers",[]),angular.module("forum.home",["home.controllers"]),angular.module("user.services",[]),angular.module("user.factories",["user.services"]),angular.module("user.directives",[]),angular.module("user.controllers",[]),angular.module("forum.user",["user.controllers","user.services","user.factories","user.directives"]),angular.module("project.services",[]),angular.module("project.directives",[]),angular.module("project.factories",["project.services"]),angular.module("project.controllers",[]),angular.module("forum.project",["project.controllers","project.factories","project.services","project.directives"]),angular.module("theme.services",["angularFileUpload"]),angular.module("theme.factories",["angularFileUpload","theme.services"]),angular.module("theme.directives",["ui.select2"]),angular.module("theme.controllers",[]),angular.module("forum.theme",["theme.controllers","theme.factories","theme.services","theme.directives"]),angular.module("forum",["forum.core","forum.home","forum.global","forum.project","forum.user","forum.theme"]),function(){angular.module("forum").config(["$httpProvider",function(e){e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",e.interceptors.push("authInterceptor")}]).config(["$sceDelegateProvider",function(e){e.resourceUrlWhitelist(["self","http://youtube.com/**","http://www.youtube.com/**","http://youtube.com/**"])}])}(),angular.module("forum").config(["$stateProvider","$urlRouterProvider",function(e,t){var o={name:"home.controllers",files:["js/home/controllers/home-controller.js"]};e.state("login",{url:"/",controller:"LoginController",templateUrl:"js/users/templates/login.html",data:{roles:[]}}).state("admin",{"abstract":!0,templateUrl:"js/layouts/default.html",data:{roles:["admin"]}}).state("admin.home",{url:"/admin",controller:"HomeController as home",templateUrl:"js/home/templates/admin-home.html",resolve:{scriptsLoad:["$ocLazyLoad",function(e){return e.load([{name:"home.controllers",files:["js/home/controllers/home-controller.js"]}])}]},data:{roles:["admin"]}}).state("admin.project",{url:"/admin/project",controller:"ProjectController",templateUrl:"js/projects/templates/list-project.html",data:{roles:["admin"]}}).state("admin.project.view",{url:"/view/:id",controller:"ProjectController",templateUrl:"js/projects/templates/add-project.html",data:{roles:["admin"]}}).state("admin.theme",{url:"/admin/theme",controller:"ThemeController",templateUrl:"js/themes/templates/list-theme.html",data:{roles:["admin"]}}).state("admin.theme.add",{url:"/add",controller:"ThemeController as theme",templateUrl:"js/themes/templates/add-theme.html",data:{roles:["admin"]}}).state("admin.theme.view",{url:"/view/:id",controller:"ThemeController as theme",templateUrl:"js/themes/templates/add-theme.html",data:{roles:["admin"]}}).state("admin.user",{url:"/admin/user",controller:"UserController as userCtrl",templateUrl:"js/users/templates/list-users.html"}).state("theme",{"abstract":!0,templateUrl:"js/layouts/theme.html",resolve:{scriptsLoad:["$ocLazyLoad",function(e){return e.load([{serie:!0,files:["js/vendor/spin.min.js","js/vendor/ladda.min.js"]},{insertBefore:"#load_css_before",files:["css/ladda.min.css"]}])}]},data:{roles:["admin"]}}).state("theme.view",{url:"/theme/view/:id",controller:"ThemeDisplayController as theme",templateUrl:"js/themes/templates/display-theme.html",resolve:{themeId:["$stateParams",function(e){return e.id}]},data:{roles:["admin","user","client"]}}).state("user",{"abstract":!0,templateUrl:"js/layouts/default.html",resolve:{scriptsLoad:["$ocLazyLoad",function(e){return e.load([{name:"home.controllers",files:["js/home/controllers/home-controller.js"]},{serie:!0,files:["js/vendor/spin.min.js","js/vendor/ladda.min.js"]},{insertBefore:"#load_css_before",files:["css/ladda.min.css"]}])}]},data:{roles:["user"]}}).state("user.home",{url:"/user",controller:"HomeController as home",templateUrl:"js/home/templates/user-home.html",data:{roles:["user"]}}).state("client",{"abstract":!0,templateUrl:"js/layouts/default.html",resolve:{scriptsLoad:["$ocLazyLoad",function(e){return e.load([{serie:!0,files:["js/vendor/spin.min.js","js/vendor/ladda.min.js"]},{insertBefore:"#load_css_before",files:["css/ladda.min.css"]}])}]},data:{roles:["client"]}}).state("client.home",{url:"/client",controller:"HomeController as home",templateUrl:"js/home/templates/client-home.html",resolve:{scriptsLoad:["$ocLazyLoad",function(e){return e.load([o])}]},data:{roles:["client"]}}),t.otherwise("/")}]),function(){angular.module("forum").config(["$translateProvider","langConst","BaseConst",function(e,t,o){e.useStaticFilesLoader({prefix:o.url+"/lang/",suffix:".json"}),e.preferredLanguage(t.default),e.useLocalStorage()}])}(),function(){function e(e,t){return{scope:{data:"="},restrict:"E",replace:!0,templateUrl:"js/global/directives/templates/breadcrumb.html",link:function(o){o.show_demo_info="demo"===t.enviroment()?!0:!1,e.getUserData().then(function(e){o.role=e.role}),o.$watch("data",function(e){o.links=e})}}}angular.module("global.directives").directive("breadcrumb",e),e.$inject=["UserService","BaseConst"]}(),function(){function e(e){return{restrict:"A",link:function(t,o,n){n.ngIf&&t.$watch(n.ngIf,function(t){t&&e(function(){o.focus()},0)})}}}angular.module("global.directives").directive("focusOn",e),e.$inject=["$timeout"]}(),function(){function e(e,t){return{replace:!0,restrict:"A",scope:{click:"&",stopEvent:"=stop"},compile:function(e,o){var n=o.style?o.style:"expand-left";e.replaceWith('<button type="submit" data-size="'+o.size+'"   data-style="'+n+'"  class="btn ladda-button"  > {{ "'+o.text+'" | translate}} </button></span>');var r;return{pre:function(){},post:function(e,o,n){t.load({serie:!0,cache:!1,files:["js/vendor/spin.min.js","js/vendor/ladda.min.js"]}).then(function(){r=Ladda.create(o[0]),o.bind("click",function(){r.start(),e.stopEvent=!1,e.click()}),angular.element(o).addClass(n.class),e.$watch("stopEvent",function(e){e!==!1&&void 0!==e&&r.stop()})})}}}}}angular.module("global.directives").directive("loadingButton",e),e.$inject=["$timeout","$ocLazyLoad"]}(),function(){function e(){return{scope:{text:"@"},template:'<div class="alert alert-info"> \n                       <p class="m-b-n"><i class="fa fa-{{type}}"></i> {{text}}</p></div>',link:function(e,t,o){e.type=void 0===o.type?"info":o.type}}}angular.module("global.directives").directive("message",e)}();var directives={};!function(){function e(){return{scope:{data:"@",service:"@"},restrict:"A",controller:["$scope","UserService","ProjectService","ThemeService",function(e,t,o,n){var r=JSON.parse(e.data);e.active=r.active,e.switch=function(t){r.active=1==t?0:1;switch(e.service){case"project":o.save({Project:r}).then(function(t){e.active=t.data.data.Project.active});break;case"theme":n.save({Theme:r}).then(function(t){e.active=t.data.data.Theme.active})}}}],templateUrl:"js/global/directives/templates/label-on-off.html",link:function(){}}}angular.module("global.directives").directive("labelOnOff",e),e.$inject=["UserService","ProjectService","ThemeService"]}(),function(){function e(){return{scope:{active:"@"},replace:!0,template:'<span class="label" ng-class="{\'label-danger\':active==0, \'label-success\':active==1 }" ><i class="fa fa-circle"></i></span>'}}angular.module("global.directives").directive("status",e)}(),function(){function e(){return{scope:{bindModel:"=model",change:"&",switchClass:"@"},replace:!0,restrict:"E",templateUrl:"js/global/directives/templates/switch.html",link:function(e){e.switchChange=function(t){e.change({model:t})}}}}angular.module("global.directives").directive("switch",e)}(),function(){function e(){return{restrict:"E",replace:!0,scope:{change:"&",bindModel:"=ngModel",btnClass:"@"},template:'<div ng-class="{\'btn-group\': true, \'btn-group-xs\':btn ==\'btn-xs\'}">\n                     <label class="btn btn-success {{btnClass}}"   ng-model="bindModel" btn-radio="\'1\'" uncheckable>{{ "ACTIVE" | translate }}</label><label class="btn btn-default {{btnClass}}"   ng-model="bindModel" btn-radio="null" uncheckable >{{ "ALL" | translate }}</label><label class="btn btn-danger {{btnClass}}"    ng-model="bindModel" btn-radio="\'0\'" uncheckable >{{ "INACTIVE" | translate }}</label>\n                    </div>',link:function(e){e.btn=e.btnClass?e.btnClass:"btn-xs",e.$watch("bindModel",function(){e.change()})}}}angular.module("global.directives").directive("changeState",e)}(),function(){function e(){return{restrict:"A",require:"ngModel",link:function(e,t,o,n){var r=new RegExp(/(youtu\.be\/|youtube\.com\/(watch\?(.*&)?v=|(embed|v)\/))([^\?&"'>]+)/);e.$watch(o.ngModel,function(e){""===e||void 0===e?n.$setValidity("youtube",!0):n.$setValidity("youtube",r.test(e))})}}}angular.module("global.directives").directive("youtubeValidate",e)}(),function(){function e(){var e=function(e,t){e.lightbox=function(){t.open({templateUrl:"js/modal/templates/youtube-modal.html",controller:["$scope","$modalInstance","$sce","code",function(e,t,o,n){console.log(n),e.url=o.trustAsResourceUrl("http://www.youtube.com/embed/"+n),e.cancel=function(){t.dismiss("cancel")}}],size:"lg",resolve:{code:function(){return e.code}}})}};return e.$inject=["$scope","$modal"],{restrict:"EA",scope:{code:"="},replace:!0,templateUrl:"js/global/directives/templates/youtube.html",controller:e}}angular.module("global.directives").directive("youtube",e),e.$inject=["$sce","$modal"]}(),function(){function e(e,t,o){return{require:"ngModel",link:function(n,r,a,i){n.$watch(a.ngModel,function(n){""!==i.$viewValue&&void 0!==i.$viewValue&&e.validate({username:n}).then(function(){i.$setValidity("unique",!1),o(function(){t.$broadcast("unique:exists",e.data)},400)},function(){i.$setValidity("unique",!0),t.$broadcast("unique:noexists",!1)})})}}}angular.module("global.directives").directive("uniqueUser",e),e.$inject=["UserFactory","$rootScope","$timeout"]}(),function(){function e(e,t,o){var n=function(e,o){e.deleteUser=function(n,r,a){n.preventDefault(),o.deleteFromProject(a).success(function(){e.projects.splice(r,1),t.$broadcast("userProjects:delete",a)})}};return n.$inject=["$scope","UserFactory"],{controller:n,transclude:!0,scope:{userUsername:"=",projectId:"="},templateUrl:"js/global/directives/templates/user-projects.html",link:function(n,r,a){n.$watch("userUsername",function(r){void 0!==r?e.view({username:r}).then(function(){n.user=e.data.User,n.projects=e.data.Project,t.$broadcast("userProjects",e.data),n.message=a.message},function(e){n.projects=[],n.message=null,t.$broadcast("userProjects",{}),o.reject(e.data)}):n.projects=[]})}}}angular.module("global.directives").directive("userProjects",e),e.$inect=["UserFactory","$rootScope","$q","$filter"],e.$inject=["UserFactory","$rootScope","$q","$filter"]}(),function(){function e(){return{require:"ngModel",link:function(e,t,o,n){return o.passwordVerify?(e.$watch(o.passwordVerify,function(e){n.$setValidity("passwordVerify",e===n.$viewValue)}),void n.$parsers.push(function(t){var r=t===e.$eval(o.passwordVerify);return n.$setValidity("passwordVerify",r),t})):void console.error("passwordVerify expects a model as an argument!")}}}angular.module("global.directives").directive("passwordVerify",e)}(),function(){function e(e,t,o){return{require:"ngModel",link:function(t,n,r,a){t.$watch(r.project,function(n){void 0!==n&&t.$watch(r.ngModel,function(t){void 0!==a.$viewValue&&""!==a.$viewValue&&e.view({username:t}).then(function(){var t=o("filter")(e.data.Project,function(e){return e.id===n?e:!1});a.$setValidity("existsInProject",!t.length)},function(){a.$setValidity("existsInProject",!0)})})})}}}angular.module("global.directives").directive("existsInProject",e),e.$inject=["UserFactory","$timeout","$filter"]}(),function(){function e(){return{restrict:"E",replace:!0,templateUrl:"js/global/directives/templates/notification.html",controller:["$scope","$timeout","$rootScope",function(e,t,o){o.$on("notification",function(o,n){return n?(angular.element(".notification").addClass("fadeInDown"),e.type=n.type,e.messages="object"==typeof n.text?n.text:[n.text],e.show=!0,void t(function(){angular.element(".notification").addClass("fadeOutUp")},5e3).then(function(){t(function(){e.show=!1,angular.element(".notification").removeClass("fadeOutUp")},1e3)})):!1})}]}}angular.module("global.directives").directive("notification",e)}(),function(){function e(e,t){return{replace:!0,restrict:"A",scope:{userData:"@"},template:' <img src="img/avatars/icon-{{image}}.png" class="img-circle" alt="" width="{{width}}" />',link:function(o,n,r){var a=!1;o.width=r.width?r.width:40,a=o.userData?JSON.parse(o.userData):!1,a?o.image=a.pictogram_id:e.getUserData().then(function(e){o.image=e.user.pictogram_id}),t.$on("pictogram_change",function(e,t){t.user.id===a.id&&(o.image=t.pictogram),a||(o.image=t.pictogram)})}}}angular.module("global.directives").directive("userImage",e),e.$inject=["UserService","$rootScope"]}(),function(){function e(e){var t=function(e,t,o,n){e.message=o,e.description=n,e.ok=function(){t.close()},e.cancel=function(){t.dismiss("cancel")}};return t.$inject=["$scope","$modalInstance","message","description"],{restrict:"A",scope:{ngConfirmClick:"&"},link:function(o,n,r){n.bind("click",function(){var n=r.ngConfirmMessage||"Naozaj vymazať ?",a=r.ngConfirmDescription||null,i=e.open({templateUrl:"js/modal/templates/confirm-modal.html",controller:t,resolve:{message:function(){return n},description:function(){return a}}});i.result.then(function(){o.ngConfirmClick()},function(){})})}}}angular.module("global.directives").directive("ngConfirm",e),e.$inject=["$modal"]}(),function(){function e(){return{restrict:"A",scope:{count:"="},template:'<div class="text-right"><small class="text-muted"> {{ "DISPLAYED_RESULTS"|  translate }} <strong>{{count ? count : 0}}</strong> {{ "RESULTS" | translate}}</small></div>'}}angular.module("global.directives").directive("paginCounter",e)}(),function(){function e(e){return{scope:{elements:"@",max:"@",min:"@"},link:function(t,o){var n,r=JSON.parse(t.elements),a=n=t.min,i=t.max,s=angular.element("#"+r.from),l=angular.element("#"+r.to);setTimeout(function(){o.height(o.parent().height())},100),angular.element(o).on("mousedown",function(t){t.preventDefault(),s.removeClass("expand").addClass("ruller-content"),angular.element(document).on("mousemove",function(t){t.preventDefault();var o=t.pageX-s.offset().left;o>a&&i>o&&t.pageX<angular.element(window).width()-n&&(s.css("width",o),l.css("margin-left",o),e.put("ruller",o))})}),angular.element(document).on("mouseup",function(){s.removeClass("ruller-content"),angular.element(document).unbind("mousemove")})}}}angular.module("global.directives").directive("ruller",e),e.$inject=["$cookieStore"]}(),function(){function e(e){return{scope:{images:"=",thumb:"@",original:"@"},templateUrl:"js/global/directives/templates/gallery.html",link:function(t){var o={thumb:t.thumb,original:t.original};t.showImage=function(n){e.open({templateUrl:"js/modal/templates/lightbox-modal.html",size:"lg",resolve:{image:function(){return angular.extend(n,o)},images:function(){var e=[];return angular.forEach(t.images,function(t){e.push(angular.extend(t,o))}),e}},controller:["$scope","$modalInstance","image","images",function(e,t,o,n){e.images=n,e.image=o,e.showImage=function(t){console.log(t),e.image=t},e.cancel=function(){t.dismiss("cancel")}}]})}}}}angular.module("global.directives").directive("gallery",e),e.$inject=["$modal"]}(),function(){function slimScroll($timeout){return{restrict:"A",link:function(scope,elem,attrs){var $resize,$opts,$options,setScroll=function(window_height){$options={height:eval(window_height?window_height:window.innerHeight)-angular.element(elem).offset().top+"px"},$opts=angular.extend({},$options,scope.$eval(attrs.slimScroll)),angular.element(elem).slimScroll($opts)};angular.element(window).on("resize",function(e){$timeout(function(){setScroll(e.target.window.innerHeight)},500)}),$timeout(function(){setScroll(),scope.$apply()},100)}}}angular.module("global.directives").directive("slimScroll",slimScroll),slimScroll.$inject=["$timeout"]}(),function(){function e(){return function(e,t,o){var n={height:"30px",overflow:"hidden"},r=angular.extend(n,e.$eval(o.autoGrow));angular.element(t).css(r);var a=function(e){void 0!==e&&t[0].scrollHeight>parseInt(r.height)&&t.css("height",t[0].scrollHeight+"px")};e.$watch(o.ngModel,function(e){a(e)}),o.$set("ngTrim","false")}}angular.module("global.directives").directive("autoGrow",e)}(),function(){function e(e,t){return function(e,o){t.$on("$stateChangeStart",function(e,t){var n=t.name.replace(/\./g,"-");o.attr("class",null).addClass(n)})}}angular.module("global.directives").directive("bodyClass",e),e.$inject=["$location","$rootScope","$route"]}(),function(){function e(e,t,o){return function(){function e(e){document.getElementsByTagName("html")[0].setAttribute("lang",e)}t.$on("lang-change",function(t,o){e(o)});var n=o.getDefault();e(n.code)}}angular.module("global.directives").directive("htmlLang",e),e.$inject=["$location","$rootScope","TranslateFactory"]}(),function(){function e(){function e(e,t,o,n){e.$watch(function(){return n.tableState()},function(){})}var t={scope:{},restrict:"EA",require:"^stTable",link:e};return t}angular.module("global.directives").directive("stCounter",e)}(),function(){function e(){function e(e,t,o){var n=t[0];t.bind("scroll",function(){n.scrollTop+n.offsetHeight>=n.scrollHeight&&e.$apply(o.loadScroll).then(function(){})})}var t={restrict:"A",link:e};return t}angular.module("global.directives").directive("loadScroll",e)}(),function(){function e(){var e={scope:{},restrict:"E",transclude:!0,replace:!0,templateUrl:"js/global/directives/templates/header.html"};return e}angular.module("global.directives").directive("pageHeader",e)}(),function(){function e(e,t,o,n,r,a,i,s,l,c,u){var m=e.tpl;return{scope:{},restrict:"E",templateUrl:m+"/navigation.json",link:function(e){e.open_notification=!1,e.notifications=0,e.userData={},e.allow_language=c.allow(),e.languages=c.languages,e.language=u.getDefault(),e.selectLanguage=function(t){e.language=t,u.changeLang(t.code)},r.getUserData().then(function(t){e.userData=t}),e.Logout=function(e){e.preventDefault();var o=i.logout();o.then(function(){t.path("/")})},e.showNotifications=function(t){t.preventDefault(),e.open_notification=e.open_notification?!1:!0},n.$on("userCommentReact:load",function(t,n){e.notifications=n.length,e.notifications||o(function(){e.open_notification=e.open_notification?!0:!1},2e3)}),n.$on("pictogram_change",function(t,o){e.userData.pictogram_id=o}),e.changePassword=function(e){e.preventDefault(),s.open({templateUrl:"js/modal/templates/change-password-modal.html",controller:"changePasswordCtrl"})},e.pictogram=function(t){t.preventDefault(),s.open({templateUrl:"js/modal/templates/pictogram-modal.html",resolve:{userData:function(){return e.userData}},controller:"pictogramCtrl"})},e.addProject=function(e){e.preventDefault(),s.open({templateUrl:"js/modal/templates/add-project-modal.html",controller:"addProjectCtrl"})}}}}angular.module("global.directives").directive("mainNav",e),e.$inject=["ApiConst","$location","$timeout","$rootScope","UserService","UserFactory","AuthService","$modal","$ocLazyLoad","langConst","TranslateFactory"]}(),function(){function e(){return{scope:{open:"=",notifications:"@data"},restrict:"E",transclude:!0,replace:!0,templateUrl:"js/global/directives/templates/sidebar-notification.html",link:function(e){e.open=e.open?!0:!1}}}angular.module("global.directives").directive("sidebarNotification",e)}(),function(){function e(e,t,o,n,r,a){function i(e){e.headers=e.headers||{};var t,o=a.getDefault();return localStorage.token&&(t=localStorage.token),t&&(e.headers.Authorization="Bearer "+t),e.headers.lang=o.code,e}function s(n){return 403==n.status&&(localStorage.token="",localStorage.role="",localStorage.user="",t.path("/"),o.$broadcast("notification",{type:"danger",text:n.data.message})),401==n.status&&t.path("/"+localStorage.role),500==n.status&&o.$broadcast("notification",{type:"danger",text:n.data.message}),e.reject(n)}function l(e){return 200===e.status&&e.data.message&&e.data.show_message&&o.$broadcast("notification",{type:"success",text:e.data.message}),"/"==t.path()&&localStorage.token&&"undefined"!=localStorage.token&&t.path("/"+localStorage.role),e}var c={request:i,responseError:s,response:l};return c}angular.module("global.factories").factory("authInterceptor",e),e.$inject=["$q","$location","$rootScope","$log","$timeout","TranslateFactory"]}(),function(){function e(e,t,o,n,r,a){function i(){var t=r.get(),n=o("filter")(e.languages,{code:t?t:e.default});return n[0]}function s(){return r.get()}function l(){return localStorage.USER_LANG}function c(e){localStorage.setItem("USER_LANG",e)}function u(e){t.use(e),c(e),n.$broadcast("lang-change",e)}function m(e){return t(e)}function d(){a.settings.strings={eng:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",numbers:[]},slo:{prefixAgo:"pred",prefixFromNow:null,suffixAgo:null,suffixFromNow:"od teraz",seconds:"menej ako minútov",minute:"minútou",minutes:"%d minútami",hour:"hodinou",hours:"%d hodinami",day:"deňom",days:"%d dňami",month:"mesiacom",months:"%d mmesiacmi",year:"rokom",years:"%d rokmi",numbers:[]}}}var f={getDefault:i,getLang:s,getUserLang:l,changeLang:u,translate:m,timeAgoSettings:d};return f}angular.module("global.factories").factory("TranslateFactory",e),e.$inject=["langConst","$translate","$filter","$rootScope","$translateLocalStorage","timeAgo"]}(),angular.module("forum").constant("BaseConst",{url:/172.24.64.33|localhost/.test(window.location.host)?"/iqual":"",enviroment:function(){var e="live";return/172.24.64.33|localhost/.test(window.location.host)&&(e="devel"),/^demo/.test(window.location.host)&&(e="demo"),e}}).constant("ApiConst",{url:/172.24.64.33|localhost/.test(window.location.host)?"/iqual/api":"/api",tpl:/172.24.64.33|localhost/.test(window.location.host)?"/iqual/api/templates":"/api/templates"}).constant("langConst",{languages:[{name:"Slovak",code:"slo"},{name:"English",code:"eng"}],allow:function(){var e=!1;return/172.24.64.33|localhost/.test(window.location.host)&&(e=!0),/^demo/.test(window.location.host)&&(e=!0),e},"default":"slo"}),function(){function e(e,t,o){e.formData={},e.success=!1,e.submitForm=function(){return o.changePassword(e.formData).then(function(t){e.success=t.data.message_modal})},e.cancel=function(){t.dismiss("cancel")}}angular.module("global.controllers").controller("changePasswordCtrl",e),e.$inject=["$scope","$modalInstance","UserFactory"]}(),function(){function e(e,t,o,n,r){e.pictogramModel=r.user.pictogram_id,e.changeModel=function(t){e.pictogramModel=t},e.$watch("pictogramModel",function(o){console.log(o,r.user.pictogram_id),o!==r.user.pictogram_id&&n.save({User:{id:r.id,pictogram_id:o}}).then(function(n){e.pictogramModel=o,t.$broadcast("notification",{type:"success",text:"piktogram uložený"}),t.$broadcast("pictogram_change",{pictogram:e.pictogramModel,user:n.data.data.User}),localStorage.setItem("user",JSON.stringify(n.data.data.User))})}),e.cancel=function(){o.dismiss("cancel")}}angular.module("global.controllers").controller("pictogramCtrl",e),e.$inject=["$scope","$rootScope","$modalInstance","UserFactory","userData"]}(),function(){angular.module("forum").run(["$rootScope","$route","$location","TranslateFactory",function(e,t,o,n){e.$on("$stateChangeStart",function(t,n){e.role=localStorage.role,-1==n.data.roles.indexOf(localStorage.role)&&o.path("/"+localStorage.role),localStorage.token&&"undefined"!=localStorage.token?localStorage.token&&"/"==o.path()&&o.path("/"+localStorage.role):o.path("/")}),n.timeAgoSettings()}])}(),function(){function e(e,t,o,n,r){e.formData={},e.save=function(){n.save(e.formData).then(function(e){o.dismiss("cancel"),r.path("/admin/project/view/"+e.data.project.Project.id)})},e.cancel=function(){o.dismiss("cancel")}}angular.module("project.controllers").controller("addProjectCtrl",e),e.$inject=["$scope","$rootScope","$modalInstance","ProjectFactory","$location"]}(),function(){function e(e,t,o,n,r,a,i,s,l,c,u,m,d){e.formData={Project:{youtube:0,image:0}},e.user_added=!1,e.filters={user_role:null},e.tabs={info:!0,users:!1,themes:!1,mail:!1},e.selectTab=function(t){angular.forEach(e.tabs,function(t,o){e.tabs[o]=!1}),e.tabs[t]=!0},e.breadcrumb=[{title:"Zoznam projektov",url:"admin.project"}];u.defer();if(e.addUserFormData={role_id:"2",Theme:[]},d.id){var f=i.view(d.id);f.then(function(t){g(t),n(function(){e.projectForm.$dirty=!1},300)})}e.changeActive=function(e,t){i.save({Project:{id:t.Project.id,active:1==e?1:0}})},e.delRow=function(t){angular.forEach(e.formData.User,function(o,n){o.id===t&&l.deleteFromProject({user:o.id,project:d.id}).then(function(){e.formData.User.splice(n,1)})})},e.selectFiles=function(e){var t=e[0].name.split(".");try{console.dir(e[0]),"csv"!==t[1].toLowerCase()&&alert("Neplatný formát súboru, povolený je len CSV"),v(e[0])}catch(o){document.getElementById("file").value=""}},e.saveProject=function(){var t=i.save(e.formData);t.then($,j)},e.clearForm=function(t){t.preventDefault(),e.addUserFormData={role_id:"2"},e.addUserForm.$setPristine(),e.addUserForm.$setUntouched()},e.filterUsers=function(t){e.filters.user_role="all"==t?null:{role_id:t}},e.addUser=function(){e.addUserFormData.id||(e.addUserFormData.id=Math.floor(1e7*Math.random()+1e6),e.addUserFormData.imported=!0,e.addUserFormData.status="success",e.addUserFormData.pictogram_id=Math.floor(5*Math.random()+1)),e.addUserFormData.notify=!0;var t=e.addUserFormData.role_id,o=e.addUserFormData;e.formData.Theme.length&&h().result.then(function(e){o=angular.extend(o,{Theme:e?e:{}})}),e.user_added=!0,e.projectForm.$dirty=!0,e.formData.User.unshift(o),e.addUserFormData={role_id:t},e.addUserForm.$setPristine()};var h=function(){return a.open({templateUrl:"js/modal/templates/add-user-themes-modal.html",size:"lg",controller:p,resolve:{themeData:function(){return e.formData},userData:function(){return e.addUserFormData}}})},p=function(e,t,o,n,r,a){e.themes=angular.copy(r),e.userData=angular.copy(a),e.addedThemes=[],e.userData.Theme&&angular.forEach(e.themes.Theme,function(t,o){var r=n("filter")(e.userData.Theme,{id:t.id});r.length&&(e.themes.Theme[o].add=!0,e.addedThemes.push(r))}),e.cancel=function(){t.dismiss("cancel")},e.add=function(t){t=angular.extend(t,{add:!0}),e.addedThemes.push(t)},e.ok=function(){t.close(e.addedThemes)},e.remove=function(t){t.add=!1,angular.forEach(e.addedThemes,function(o,n){t.id==o.id&&e.addedThemes.splice(n,1)})},e.all=function(){var t=[];angular.forEach(e.themes.Theme,function(o,n){e.addedThemes.length||t.push(o),e.themes.Theme[n].add=!e.addedThemes.length}),e.addedThemes=t}};p.$inject=["$scope","$modalInstance","ThemeFactory","$filter","themeData","userData"];var g=function(t){e.formData=t.data,s.getUserData().then(function(t){""==e.formData.Project.uname&&""==e.formData.Project.email&&(e.formData.Project.uname=t.user.name,e.formData.Project.email=t.user.username)})},v=function(t){window.FileReader||alert("FileReader are not supported in this browser.");var o=ReadUserFile.readFile(t);o.then(function(t){angular.forEach(t,function(t){var o={pictogram_id:Math.floor(5*Math.random()+1),role_id:2};s.find({username:t.username}).then(function(){e.formData.Respondent.unshift(angular.extend(t,{status:"error"},o))},function(){var n=angular.extend(t,{status:"success"},o);e.formData.Respondent.unshift(n)})}),e.user_added=!0})},$=function(e){g({data:e.data.project})},j=function(){};o.$on("userProjects",function(t,o){o.User?(e.showUserProjectsTable=!0,e.addUserFormData=angular.extend(o.User,{Theme:o.Theme})):e.addUserFormData.name&&(e.addUserFormData="")}),o.$on("userProjects:delete",function(t,o){angular.forEach(e.formData.Respondent,function(t,n){t.id===o.user&&e.formData.Respondent.splice(n,1)})})}angular.module("project.controllers").controller("ProjectController",e),e.$inject=["$scope","$location","$rootScope","$timeout","AuthService","$modal","ProjectService","UserService","UserFactory","filterFilter","$q","$log","$stateParams"]}(),function(){"use strict";function e(e,t,o,n){function r(){o.dismiss("cancel")}function a(e){t.deleteFromProject({user:e,project:s.project_id}).then(function(){i(e)})}function i(e){angular.forEach(s.data,function(t,o){t.User.id===e&&s.data.splice(o,1)})}var s=this;s.cancel=r,s.remove=a,s.data=n.data,s.project_id=n.project_id}angular.module("project.controllers").controller("projectUsersCtrl",e),e.$inject=["$scope","UserFactory","$modalInstance","ResolveData"]}(),function(){function projectListTable(){return{scope:{filter:"@"},restrict:"A",replace:!0,templateUrl:"js/projects/directives/templates/project-list-table.html",controller:projectListTableCtrl,controllerAs:"ctrl"}}function projectListTableCtrl($scope,ProjectFactory,$timeout){function changeActive(e,t){ProjectFactory.save({Project:{id:t,active:e===!0?1:0}})}function deleteRow(e){var t=ProjectFactory.delete(e);t.then(deleteSuccess)}function deleteSuccess(e){$timeout(function(){angular.forEach($this.projects,function(t,o){t.Project.id===e.data.id&&$this.projects.splice(o,1)})},400)}var $this=this;$this.projects=[],$this.pages=[5,10,15],$this.onPage=10,$this.isLoading=!1,$this.results=!0,$this.changeActive=changeActive,$this.deleteRow=deleteRow,$this.filters=$scope.$eval($scope.filter),this.loadData=function callServer(tableState){$this.isLoading=!0;var pagination=tableState.pagination,start=pagination.start||0,number=pagination.number||$this.onPage;ProjectFactory.getPage(start,number,tableState,$this.filters).then(function(result){var number_to=eval(parseInt(number)+parseInt(start));$this.projects=result.data,$this.table={start:start+1,number:number_to<result.total?number_to:result.total,total:result.total},tableState.pagination.numberOfPages=result.numberOfPages,$this.isLoading=!1,$this.results=void 0!==$this.projects?!0:!1})}}angular.module("project.directives").directive("projectListTable",projectListTable).controller("projectListTableCtrl",projectListTableCtrl),projectListTableCtrl.$inject=["$scope","ProjectFactory","$timeout"]}(),function(){"use strict";function e(e,t,o){function n(e,t,o){t.bind("click",function(e){r(o,e)})}function r(t,n){n.preventDefault(),e.open({controller:"projectUsersCtrl as ctrl",templateUrl:"js/modal/templates/project-users-modal.html",size:"lg",resolve:{ResolveData:function(){return o.users(t.projectId).then(function(){return{data:o.data,project_id:t.projectId}})}}})}var a={scope:{projectId:"@"},restrict:"A",link:n};return a}angular.module("project.directives").directive("projectUsers",e),e.$inject=["$modal","UserFactory","ProjectFactory"]}(),function(){function e(e,t,o){function n(e,t,o,n){var n=n?n:{};return a(angular.extend({_recursive:1,limit:t,offset:e,order:"id DESC"},n)).then(function(){return{data:h.data,total:h.total,numberOfPages:Math.ceil(h.total/t)}})}function r(e,o){return t.themes(e,o).success(m).error(d)}function a(e){return t.list(e).success(m).error(d)}function i(e){return t.view(e)}function s(e){return t.users(e).then(function(e){h.data=e.data.User})}function l(e){return t.delete(e)}function c(e){return t.save(e)}function u(e){var t=o.defer(),n=a(angular.extend({_dropdown:!0,order:"newest"},e)),r=[];return n.then(function(){angular.forEach(h.data,function(e){r.push(e.Project)}),t.resolve(r)}),t.promise}function m(e){h.data=e.rows,h.total=e.total
}function d(){}function f(e,o){return t.sendMail(e,o)}var h={data:[],total:0,getList:a,findById:i,"delete":l,save:c,dropdown:u,getPage:n,users:s,themes:r,sendMail:f};return h}angular.module("project.factories").factory("ProjectFactory",e),e.$inject=["$http","ProjectService","$q","$translate"]}(),function(){function e(e,t,o,n){this.api=n.url,this.list=function(e){return t.get(this.api+"/projects",{params:e})},this.delete=function(e){return t.delete(this.api+"/projects/delete",{params:{id:e}})},this.view=function(e){return t.get(this.api+"/projects/view",{params:{id:e}})},this.users=function(e){return t.get(this.api+"/projects/users/"+e)},this.save=function(e){return t.post(this.api+"/projects/save",{data:e})},this.themes=function(e,o){return t.get(this.api+"/projects/"+e+"/themes",{params:o})},this.sendMail=function(e,o){return t.post(this.api+"/projects/mail/"+e,o)}}angular.module("project.services").service("ProjectService",e),e.$inject=["$q","$http","$rootScope","ApiConst"]}(),function(){function e(e,t,o,n,r,a,i,s){this.formData={notify:0,User:null,Comment:{parent_id:0,private_id:0,youtube:""}},this.form_opened=!1;var l=this;l.user_reply_id_value=!1,e.$on("openCommentForm",function(e,t){l.user_reply_id_value=!1,"object"==typeof t&&(l.formData={notify:t.hasOwnProperty("parent_id")||t.private?1:0,Comment:{parent_id:t.hasOwnProperty("parent_id")?t.parent_id:0,private_id:t.private||0},Theme:t.theme,User:t},t.user_reply_id_value&&(l.user_reply_id_value=t.user_reply_id_value))}),r.isAuthorized().then(function(e){l.user=e.data}),e.$on("onProgress",function(t,o){e.progress=o}),this.onFileSelect=function(t){e.selectedFiles=[],e.progress=[],e.upload=[],e.uploadResult=[],e.selectedFiles=t,e.dataUrls=[];for(var o=0;o<t.length;o++){var n=t[o];if(window.FileReader&&n.type.indexOf("image")>-1){var r=new FileReader;r.readAsDataURL(t[o]);{(function(t,o){t.onload=function(t){e.dataUrls[o]=t.target.result}})(r,o)}}e.progress[o]=-1}},this.submitForm=function(){angular.extend(l.formData.Comment,{theme_id:s.id}),1===l.formData.Comment.private_id&&(l.formData.Comment.private_id=l.user_reply_id_value);var t=n.save(l.formData);t.then(function(t){e.selectedFiles?n.upload(e.selectedFiles,t.data).then(function(){c()}):c()},u)};var c=function(){e.commentForm.$setPristine(),l.formData={},e.$emit("afterSavedComment")},u=function(e){t.$broadcast("notification",{type:"danger",text:e.data.message})}}angular.module("theme.controllers").controller("ThemeCommentCtrl",e),e.$inject=["$scope","$rootScope","$timeout","CommentService","AuthService","$location","$modal","$stateParams"]}(),function(){"use strict";function e(e,t,o,n,r){this.CommentFactory=t,this.rootScope=o,this.$timeout=n,this.formData={},this.CommentData={},this.comments=[],this.moveListLeft=!1,this.$=angular.element;var a=this;o.$on("userCommentReact:reload",function(){});var i=r(function(){a.list()},2e4);e.$on("$destroy",function(){r.cancel(i)}),this.save=function(){var e=this,t=this.formData.message,o={theme_id:this.CommentData.Comment.theme_id,parent_id:this.CommentData.Comment.id,text:t};this.CommentFactory.saveReaction({Comment:o,notify:1}).then(function(){e.__closeReply(),e.list()})},this.reply=function(e){this.moveListLeft=!0,this.CommentData=e},this.deleteComment=function(e){var t=this,o=angular.extend(angular.copy(e),{reaction:1});this.CommentFactory.save({Comment:o,show_message:!1}).then(function(){t.list()})},this.closeReply=function(e){e.preventDefault(),this.__closeReply()},this.__closeReply=function(){this.moveListLeft=!1,this.__clearForm()},this.__clearForm=function(){this.formData={},this.CommentData={}},this.list=function(){var e=this;this.CommentFactory.getAllReactions().then(function(){e.success(e.CommentFactory.data),e.rootScope.$broadcast("userCommentReact:load",e.CommentFactory.data)})},this.success=function(e){this.comments=e},this.list()}angular.module("theme.controllers").controller("ThemeUserReactController",e),e.$inject=["$scope","CommentFactory","$rootScope","$timeout","$interval"]}(),function(){"use strict";function e(e,t,o){this.comment=null,this.submitForm=function(){var t=JSON.parse(e.themeData);o.save({Comment:{theme_id:t.id,text:this.comment}}).then(n)};var n=function(){e.$emit("afterSavedComment")}}angular.module("theme.controllers").controller("PostCommentFormCtrl",e),e.$inject=["$scope","$rootScope","CommentFactory"]}(),function(){"use strict";function e(e,t,o,n,r,a,i,s,l,c,u,m,d,f){if(e.formData={ThemeImage:[]},e.theme_id=f.id,e.htmlContent="",e.tabs={info:!0,foto:!1,project:!1,users:!1},e.selectTab=function(t){angular.forEach(e.tabs,function(t,o){e.tabs[o]=!1}),e.tabs[t]=!0},e.users=[],e.theme_users=[],e.breadcrumb=[{title:"Zoznam tem"}],f.id){var h=l.view(f.id);h.then(function(){e.formData=l.data,e.theme_users=l.data.User,p({theme_id:f.id,project_id:l.data.Theme.project_id})})}e.changeActive=function(e,t){s.save({Theme:{id:t.Theme.id,active:1==e?1:0}})};var p=function(t){e.users=[];var o={project_id:e.formData.Theme.project_id,theme_id:e.formData.Theme.id},n=angular.extend(o,t);void 0!==n.theme_id&&s.view(n.theme_id).then(function(t){e.theme_users=t.data.Theme.project_id!==n.project_id?[]:t.data.User}),c.notInTheme(n.theme_id).then(function(t){angular.forEach(t.data.rows,function(t){e.users.push(t.User)})})};e.loadUsers=function(e){p(e)},e.removeUser=function(t){e.users.splice(0,0,t),e.theme_users=d("filter")(e.theme_users,{id:t.id},function(e,t){return e!==t?!0:!1})},e.addUser=function(t){e.theme_users.splice(0,0,t),e.users=d("filter")(e.users,{id:t.id},function(e,t){return e!==t?!0:!1})},e.addAll=function(){var t=(m.defer(),angular.forEach(e.users,function(t){e.theme_users.push(t)}));m.all(t).then(function(){e.users=[]})},e.deleteAll=function(){var t=(m.defer(),angular.forEach(e.theme_users,function(t){e.users.push(t)}));m.all(t).then(function(){e.theme_users=[]})},e.saveTheme=function(){e.formData.User=e.theme_users;var t=s.save(e.formData);t.then(g,v)},e.onFileSelect=function(t){e.uploadProgress=!0,e.upload=l.uploadFile(t,e.formData),e.upload.progress(function(t){var o=parseInt(100*t.loaded/t.total);e.uploadProgress=o}).success(function(t){e.uploadProgress=!1,e.formData.ThemeImage.push({image:t.foto})})},e.deleteImage=function(t,o){l.deleteImage({id:o}).then(function(){e.formData.ThemeImage.splice(t,1)})};var g=function(e){t.path("admin/theme/view/"+e.data.data.Theme.id)},v=function(){}}angular.module("theme.controllers").controller("ThemeController",e),e.$inject=["$scope","$location","$rootScope","$http","AuthService","$modal","ProjectService","ThemeService","ThemeFactory","UserService","ReadUserFile","$q","$filter","$stateParams"]}(),function(){"use strict";function e(e,t,o,n,r,a,i,s,l,c,u,m,d,f,h,p,g,v){var j=0,b=this;this.cookie_sidebar=h.get("ruller"),this.selected_comments=[],this.comments=[],this.themes_load_params={},this.selected_comment={id:null,name:null},this.theme_more_toggle=!0,this.full_screen=this.toggle_theme=!1,e.theme_data={},this.form_opened=!1,this.load_more_counter=0,b.setup={reply:!1,add_comment:!1,"export":!1},c.getUserData().then(function(e){switch(b.user=e.user,b.user.role=e.role,b.user.role){case"admin":b.setup={reply:!0,add_comment:!0,"export":!0};break;case"user":b.setup={reply:!0,add_comment:!0,"export":!1}}}),e.filterForm={order:"newest"};var y=function(){s.view(v).then(_,U)},_=function(e){b.theme=e.data,b.theme.User=p("filter")(e.data.User,{role_id:2}),m.themes(e.data.Theme.project_id,{active:1}).then(function(){b.themes=m.data,m.data||"admin"==b.user.role||b.fullScreen(null)})},U=function(e){o.$broadcast("notification",{type:"danger",text:e.message}),n.path("/")};e.$on("$viewContentLoaded",function(){var e=$(window).height();$(".vbox").height(e)}),e.$on("afterSavedComment",function(){S()}),e.$on("closeCommentForm",function(){angular.element(".forum-footer .comment-item").remove(),angular.element(".forum-footer #js-theme-info").remove(),b.form_opened=!1}),e.$on("openCommentForm",function(){b.form_opened=!0}),e.$watch("filterForm.order",function(e){S({order:e})}),e.$watch("theme_edit",function(e){e&&(b.theme_more_toggle=e)}),this.refreshThemes=function(){l.getList(b.themes_load_params).then(function(){b.themes=l.data})},this.saveTheme=function(){var e={Theme:{text:b.theme.Theme.text,id:v}};l.save(e)},this.replyComment=function(e,t){var n={user_reply_id_value:t.id,parent_id:e,theme:b.theme},r=angular.element("#comment-id-"+e).clone();angular.element(".forum-footer").prepend(r),o.$broadcast("openCommentForm",angular.extend(t,n))},this.fullScreen=function(){angular.element("#nav").toggleClass("nav-xs"),angular.element("#aside-bar").toggleClass("nav-xs"),angular.element("#aside-content").toggleClass("content-lg"),this.full_screen=this.full_screen===!1?!0:!1},this.toggleTheme=function(){angular.element("#aside-theme").toggleClass("expand").css("width",""),this.toggle_theme=this.toggle_theme===!1?!0:!1},this.addComment=function(e,t,n){var r={};if("object"==typeof t&&(r=angular.extend({theme:b.theme,"private":n?1:0},t,{user_reply_id_value:t.hasOwnProperty("id")===!0?t.id:0})),!b.form_opened){if(0===Object.keys(r).length){var a=angular.element("#js-theme-info").clone();angular.element(".forum-footer").prepend(a)}o.$broadcast("openCommentForm",r)}},this.refreshComments=function(e){b.new_comments,j=0,S(e)},this.export=function(){i.open({templateUrl:"js/modal/templates/export-theme-modal.html",controller:["$scope",function(e){e.comments=b.comments,e.selectText=function(e){if(document.selection){var t=document.body.createTextRange();t.moveToElementText(document.getElementById(e)),t.select()}else if(window.getSelection){var t=document.createRange();t.selectNode(document.getElementById(e)),window.getSelection().addRange(t)}}}],size:"lg"})},this.deSelectComments=function(e){b.selected_comment={};var t=angular.element(".comment-user-"+e);angular.forEach(t,function(e,t){angular.element(e).removeClass("comment-selected"),b.selected_comments.splice(t,1)})},this.selectComments=function(e,t){return b.selected_comments=[],b.selected_comments=angular.element(".comment-user-"+e),b.selected_comments.length?(b.selected_comment={id:e,name:t},void w()):void alert("Tento respondent nema zatial žiadne príspevky")};var w=function(){b.selected_comment.id&&(b.selected_comments=angular.element(".comment-user-"+b.selected_comment.id),angular.forEach(b.selected_comments,function(e){angular.element(e).addClass("comment-selected")}))},S=function(t){var o=(angular.extend({theme_id:v},t,e.filterForm),a.theme(v,0,e.filterForm));angular.element(".fa-refresh").addClass("rotate"),o.then(function(e){angular.element(".fa-refresh").removeClass("rotate"),F(e),b.load_more_counter=0})};this.filterUsers=function(e){this.state_users="all"==e?null:{comments:e}};var C=function(){b.users=[],l.users(v).then(function(){angular.forEach(l.data,function(e){b.users.push(e)})})},F=function(e){b.comments="null"===e.data?[]:e.data.rows,t(function(){w()},200)};this.loadScroll=function(){return e.load_more_loading=!0,b.load_more_counter++,a.theme(v,b.load_more_counter,{}).then(function(e){e.data.rows.length&&angular.forEach(e.data.rows,function(e){b.comments.push(e)})})},y(),S(),"admin"===localStorage.role&&C()}angular.module("theme.controllers").controller("ThemeDisplayController",e),e.$inject=["$scope","$timeout","$rootScope","$location","$route","CommentService","$modal","ThemeService","ThemeFactory","UserService","UserFactory","ProjectFactory","$q","$interval","$cookieStore","$filter","$stateParams","themeId"]}(),function(){function ThemeListCtrl($scope,ThemeFactory,ProjectFactory,$location,$modal,$timeout){function getProjectsDropDown(){ProjectFactory.dropdown().then(function(e){$this.projects=e})}function callServer(tableState){$this.isLoading=!0;var pagination=tableState.pagination,start=pagination.start||0,number=pagination.number||$this.onPage;ThemeFactory.getPage(start,number,tableState,$this.filters).then(function(result){var number_to=eval(parseInt(number)+parseInt(start));$this.themes=result.data,$this.table={start:start+1,number:number_to<result.total?number_to:result.total,total:result.total},tableState.pagination.numberOfPages=result.numberOfPages,$this.isLoading=!1,$this.results=void 0!==$this.themes?!0:!1})}function deleteRow(e){var t=ThemeFactory.delete(e);t.then(deleteSuccess,error)}function changeActive(e,t){ThemeFactory.save({Theme:{id:t,active:e===!0?1:0}})}var $this=this;$this.themes=$scope.themes?$scope.themes:[],$this.filters=$scope.filters?$scope.$eval($scope.filters):{},$this.isLoading=!1,$this.changeActive=changeActive,$this.loadData=callServer,$this.pages=[5,10,15,20],$this.onPage=15,$this.results=!0,$this.deleteRow=deleteRow,getProjectsDropDown();var deleteSuccess=function(e){$timeout(function(){angular.forEach($this.themes,function(t,o){if(t.Theme.id==e.data.id){var n=angular.element(".theme-item")[o];angular.element(n).addClass("fadeOutDown"),$timeout(function(){$this.themes.splice(o,1)},400).then(function(){angular.element(n).removeClass("fadeOutDown").addClass("fadeInUp")})}})},400)},error=function(){}}angular.module("theme.controllers").controller("ThemeListCtrl",ThemeListCtrl),ThemeListCtrl.$inject=["$scope","ThemeFactory","ProjectFactory","$location","$modal","$timeout"]}(),function(){function ThemeListModalCtrl($scope,ThemeFactory,$location,$modal,$timeout,$modalInstance,project_id){function cancelModal(){$modalInstance.dismiss("cancel")}function callServer(tableState){$this.isLoading=!0;var pagination=tableState.pagination,start=pagination.start||0,number=pagination.number||$this.onPage;ThemeFactory.getPage(start,number,tableState,{project_id:$this.project_id}).then(function(result){var number_to=eval(parseInt(number)+parseInt(start));$this.themes=result.data,$this.table={start:start+1,number:number_to<result.total?number_to:result.total,total:result.total},tableState.pagination.numberOfPages=result.numberOfPages,$this.isLoading=!1,$this.results=void 0!==$this.themes?!0:!1})}function deleteRow(e){var t=ThemeFactory.delete(e);t.then(deleteSuccess)}function changeActive(e,t){ThemeFactory.save({Theme:{id:t,active:1==e?1:0}})}function deleteSuccess(e){$timeout(function(){angular.forEach($this.themes,function(t,o){t.Theme.id==e.data.id&&$this.themes.splice(o,1)})},400)}var $this=this;$this.themes=[],$this.project_id=project_id?project_id:null,$this.filters={},$this.changeActive=changeActive,$this.loadData=callServer,$this.pages=[5,10,15],$this.onPage=5,$this.isLoading=!1,$this.results=!0,$this.cancel=cancelModal}angular.module("theme.controllers").controller("ThemeListModalCtrl",ThemeListModalCtrl),ThemeListModalCtrl.$inject=["$scope","ThemeFactory","$location","$modal","$timeout","$modalInstance","project_id"]}(),function(){function e(e,o){return{scope:{projectId:"@"},restrict:"A",replace:!1,link:function(e,n){n.bind("click",function(n){n.preventDefault(),o.open({templateUrl:"js/modal/templates/add-theme-modal.html",resolve:{projectId:function(){return e.projectId}},controller:t})})}}}function t(e,t,o,n,r,a,i){e.formData={project_id:i?i:null};e.projectId=i?i:null,n.dropdown({active:1}).then(function(t){e.projects=t}),e.save=function(){r.save(e.formData).then(function(e){o.dismiss("cancel"),a.path("/admin/theme/view/"+e.data.data.Theme.id)})},e.cancel=function(){o.dismiss("cancel")}}angular.module("theme.directives").directive("addNewTheme",e).controller("addThemeCtrl",t),e.$inject=["$ocLazyLoad","$modal"],t.$inject=["$scope","$rootScope","$modalInstance","ProjectFactory","ThemeFactory","$location","projectId"]}(),function(){function e(){return{require:"^ngModel",scope:{ngModel:"=",deleteImage:"&"},restrict:"A",templateUrl:"js/themes/directives/templates/image-list.html"}}angular.module("theme.directives").directive("imagesList",e)}(),function(){function e(){var e={scope:{theme:"=",saveFn:"&"},restrict:"A",replace:!0,templateUrl:"js/themes/directives/templates/theme-add-form.html",controller:t,controllerAs:"ctrl",link:function(){}};return e}function t(e,t,o){var n=this;this.formData={},e.$watch("theme",function(e){n.formData=e}),t.dropdown().then(function(e){n.projects=e}),this.changeActive=function(){var e=1==n.formData.Theme.active?"aktivna":"neaktívna";r(e)},this.changeType=function(){var e=1==n.formData.Theme.type?"one to one":"public";r(e)};var r=function(){o.save({Theme:n.formData.Theme})}}angular.module("theme.directives").directive("themeAddForm",e).controller("themeAddCormCtrl",t),t.$inject=["$scope","ProjectFactory","ThemeFactory"]}(),function(){"use strict";function e(){return{scope:{themeData:"@"},restrict:"E",templateUrl:"js/themes/directives/templates/post-comment-form.html",controller:"PostCommentFormCtrl",controllerAs:"ctrl",link:function(e,t){t.find("textarea").focus()}}}angular.module("theme.directives").directive("commentForm",e),e.$inject=["$rootScope"]}(),function(){function e(e){return{scope:{comments:"=",replyComment:"&"},restrict:"E",replace:!0,template:'<div><theme-comment-item reply-comment="reply" comment="comment" ng-repeat="comment in comments"></theme-comment-item></div>',controller:["$scope",function(t){this.getUser=function(){return e.getUserData()},t.reply=function(e,o){t.replyComment()(e,o)}}]}}angular.module("theme.directives").directive("themeCommentsList",e),e.$inject=["UserService"]}(),function(){function e(e){return{scope:{comment:"=",replyComment:"&"},require:"^themeCommentsList",restrict:"E",replace:!0,templateUrl:"js/themes/directives/templates/theme-comment-item.html",link:function(t,o,n,r){t.setup={},r.getUser().then(function(e){var o=e.role,n=e.user;t.setup={reply:/admin|user/.test(o)&&n.id!=t.comment.User.id?!0:!1}}),t.reply=function(e,o){t.replyComment()(e,o)};var a='<div class="comment-reply"><theme-comments-list reply-comment="reply" comments="comment.children"  ></theme-comments-list></div>';angular.isArray(t.comment.children)&&e(a)(t,function(e){o.append(e)})}}}angular.module("theme.directives").directive("themeCommentItem",e),e.$inject=["$compile"]}(),function(){function e(){return{scope:{filters:"@"},restrict:"A",templateUrl:"js/themes/directives/templates/theme-list-table.html",controller:"ThemeListCtrl",controllerAs:"ctrl"}}angular.module("theme.directives").directive("themeList",e)}(),function(){function e(e){function t(e,t,n){t.bind("click",function(e){o(n,e)})}function o(t,o){o.preventDefault(),e.open({controller:"ThemeListModalCtrl as ctrl",templateUrl:"js/modal/templates/themes-table-modal.html",size:"lg",resolve:{project_id:function(){return t.projectId}}})}var n={scope:{projectId:"@"},restrict:"A",link:t};return n}angular.module("theme.directives").directive("themeListModal",e),e.$inject=["$modal","ThemeFactory"]}(),function(){"use strict";function e(){function e(e,t){e.$on("openCommentForm",function(){n(t,e)}),e.$on("afterSavedComment",function(){o(t,e)}),e.closeForm=function(){o(t,e)}}function o(e,o){o.form_opened=!1,(new t).CloseForm({elem:e,height:110,callback:function(){o.comment.formData={},o.selectedFiles=[],o.$emit("closeCommentForm")}})}function n(e,n){n.form_opened=!0,(new t).OpenForm({elem:e,height:400,callback:function(){angular.element(".forum-textarea").focus(),angular.element(".modal-backdrop").on("click",function(){o(e,n)})}})}var r={scope:{showForm:"&",data:"="},restrict:"E",replace:!0,templateUrl:"js/themes/directives/templates/theme-post-comment.html",controller:"ThemeCommentCtrl",controllerAs:"comment",link:e};return r}function t(){var e=function(e){r(e),o(e)},t=function(e){o(e,n())},o=function(e){angular.element(e.elem).height()+1!==e.height&&e.elem.animate({height:e.height,"z-index":1050},{duration:400,complete:e.callback})},n=function(){$(".comment-backdrop").length&&$(".comment-backdrop").fadeOut(300,function(){$(this).remove()})},r=function(){setTimeout(function(){if(!$(".comment-backdrop").length){var e=$("<div/>",{"class":"modal-backdrop comment-backdrop in",style:" display: none"});$("body").append($(e)),$(e).fadeIn(200)}$(".js-forum-footer-close").removeClass("hide")},300)};return{OpenForm:e,CloseForm:t}}angular.module("theme.directives").directive("postComment",e),e.$inject=["$rootScope","AuthService"]}(),function(){"use strict";function e(){return{scope:{},restrict:"E",replace:!0,templateUrl:"js/themes/directives/templates/theme-user-comment-react.html",controller:"ThemeUserReactController",controllerAs:"ctrl"}}angular.module("theme.directives").directive("userCommentReact",e)}(),function(){function e(e,t){function o(e){return t.user(e).success(l).error(c)}function n(e){return t.save(e)}function r(e){return t.list(e).success(l).error(c)}function a(e){return t.listReactions(e).success(l).error(c)}function i(e){return t.save(e).then(function(){return n({Comment:{id:e.Comment.parent_id,reaction:1}})})}function s(e){var o={limit:5,type:"all",order:"newest",by_user:!1};return t.list(angular.extend(o,e)).success(l).error(c)}function l(e){u.data=e.rows}function c(){}var u={data:[],getList:r,getAllReactions:a,saveReaction:i,getLastComments:s,save:n,user:o};return u}angular.module("theme.factories").factory("CommentFactory",e),e.$inject=["$http","CommentService"]}(),function(){function e(e,t){function o(e,t,o,r){var a=o.search.predicateObject?o.search.predicateObject:{},o=angular.extend({limit:t,offset:e},a,r);return n(o).then(function(){return{data:f.data,total:f.total,numberOfPages:Math.ceil(f.total/t)}})}function n(e){return t.list(e).success(m).error(d)}function r(e){return t.list(e).success(m).error(d)}function a(e,o){return t.upload(e,o)}function i(e){return t.save(e)}function s(e){return t.users(e,{}).then(function(e){f.data=e.data})}function l(e){return t.deleteImage(e)}function c(e){return t.delete(e)}function u(e){return t.view(e).then(function(e){f.data=e.data})}function m(e){f.data=e.rows,void 0!==e.total&&(f.total=e.total)}function d(){}var f={data:[],total:0,getList:n,getUserThemes:r,uploadFile:a,save:i,deleteImage:l,"delete":c,view:u,getPage:o,users:s};return f}angular.module("theme.factories").factory("ThemeFactory",e),e.$inject=["$http","ThemeService"]}(),function(){function e(e,t,o,n,r,a,i,s){function l(){n.open({templateUrl:"js/modal/templates/chose-lang-modal.html",size:"sm",backdrop:"static",controller:["$scope","langConst","$modalInstance","$timeout",function(e,t,o,n){e.languages=t.languages,e.selectLanguage=function(e){o.dismiss("cancel"),n(function(){i.changeLang(e.code)},300)},e.cancel=function(){o.dismiss("cancel")}}]})}e.loginError=!1,e.show_form=!0,e.accounts=[],e.Login={},o.$on("lang-change",function(){e.show_form=!0}),void 0!==localStorage.accounts&&(e.accounts=localStorage.accounts.split(";")),e.selectUser=function(t){e.accounts.length=0,e.accounts.push(t)},e.removeUser=function(t){e.accounts.splice(t,1)},i.getUserLang()||"live"===s.enviroment()||(e.show_form=!1,l()),e.UserLogin=function(){var t=1===e.accounts.length?e.accounts[0]:e.Login.username,o={username:t,password:e.Login.password,remember:e.Login.remember},n=r.login(o);n.then(c,u)},e.forgot=function(){n.open({templateUrl:"js/modal/templates/forgot-modal.html",controller:"UserForgotModalCtrl as ctrl"})};var c=function(e){m(e.data),t.path("/"+e.data.role)},u=function(t){e.loginError=t.data.message},m=function(e){localStorage.setItem("token",e.token),localStorage.setItem("role",e.role),localStorage.setItem("user",JSON.stringify(e.user)),d(e.user.username)},d=function(e){var t=localStorage.accounts,o=[];if(void 0!==t){o=t.split(";");for(var n=0;n<=o.length;n++)o[n]===e&&o.splice(n,1)}o.push(e),localStorage.setItem("accounts",o.join(o.length>1?";":""))}}angular.module("user.controllers").controller("LoginController",e),e.$inject=["$scope","$location","$rootScope","$modal","AuthService","langConst","TranslateFactory","BaseConst"]}(),function(){function e(e,t,o){function n(){t.dismiss("cancel")}function r(){s.formData.role_id=1,s.formData.pictogram_id=1,o.register(s.formData).then(a,i)}function a(e){s.success=e.data.message}function i(e){s.error=e.data.message}var s=this;s.formData={},s.success=null,s.error=null,s.cancel=n,s.saveModalForm=r}angular.module("user.controllers").controller("newAccountModalCtrl",e),e.$inject=["$scope","$modalInstance","UserFactory","$timeout"]}(),function(){"use strict";function e(e,o,n,r,a,i){this.breadcrumb=[{title:"Zoznam užívateľov"}];var s=this,l={templateUrl:"js/modal/templates/user-modal.html",controller:t,resolve:{data:function(){return s.user}}};this.viewUser=function(e){i.view({id:e}).then(function(){s.user=i.data,r.open(l)})}}angular.module("user.controllers").controller("UserController",e),e.$inject=["$scope","$rootScope","$location","$modal","ThemeFactory","UserFactory","$q","$timeout"];var t=function(e,t,o){e.data=o}}(),function(){function e(e,t,o,n,r){function a(){t.dismiss("cancel")}function i(){o.forgot(c.formData).then(s,l)}function s(e){c.success=e.data.message,r(function(){a()},2e3)}function l(e){c.error=e.data.message}var c=this;c.formData={},c.success=null,c.error=null,c.cancel=a,c.saveModalForm=i}angular.module("user.controllers").controller("UserForgotModalCtrl",e),e.$inject=["$scope","$modalInstance","AuthService","$log","$timeout"]}(),function(){function UsersListCtrl($scope,UserFactory,ProjectFactory,$location,$timeout,$filter){function getUserRolesDropDown(){UserFactory.getRoles().then(function(){$this.roles=UserFactory.roles})}function callServer(tableState){$this.isLoading=!0;var pagination=tableState.pagination,start=pagination.start||0,number=pagination.number||$this.onPage;UserFactory.getPage(start,number,tableState,$this.filters).then(function(result){var number_to=eval(parseInt(number)+parseInt(start));$this.users=result.data,$this.table={start:start+1,number:number_to<result.total?number_to:result.total,total:result.total},tableState.pagination.numberOfPages=result.numberOfPages,$this.isLoading=!1,$this.results=void 0!==$this.users?!0:!1})}function deleteRow(e){var t=UserFactory.delete(e);t.then(deleteSuccess,error)}function deleteSuccess(e){$timeout(function(){angular.forEach($this.users,function(t,o){t.User.id==e.data.id&&$this.users.splice(o,1)})},400)}var $this=this;$this.users=[],$this.filters={},$this.isLoading=!1,$this.loadData=callServer,$this.pages=[5,10,15],$this.onPage=15,$this.results=!0,$this.deleteRow=deleteRow,getUserRolesDropDown();var getProjectsDropDown=function(){ProjectFactory.dropdown().then(function(e){$this.projects=e,$this.filters.project_id&&($this.selected_project=$filter("filter")($this.projects,{id:$this.filters.project_id}))})},getRoles=function(){UserFactory.getRoles().then(function(){$this.roles=UserFactory.roles,$this.filters.role_id&&($this.selected_role=$filter("filter")($this.roles,function(e){return e.Role.id==$this.filters.role_id?e.Role.text:null}))})},error=function(){}}angular.module("user.controllers").controller("UsersListCtrl",UsersListCtrl),UsersListCtrl.$inject=["$scope","UserFactory","ProjectFactory","$location","$timeout","$filter"]}(),function(){"use strict";function e(e,t,o,n){var r={project:function(e,o){return t.deleteFromProject({user:e,project:o})},theme:function(e,o){return t.deleteFromTheme({user:e,theme:o})}},a={project:function(){return{title:"Zoznam respondentov v projekte"}},theme:function(){return{title:"Zoznam respondentov v téme"}}};e.users=n.users,e.id=n.id,e.type=n.type,e.text=a[e.type](),e.cancel=function(){o.dismiss("cancel")},e.remove=function(t){r[e.type](t,e.id).then(function(){i(t)})};var i=function(t){angular.forEach(e.users,function(o,n){o.User.id===t&&e.users.splice(n,1)})}}angular.module("user.controllers").controller("UserListModalCtrl",e),e.$inject=["$scope","UserFactory","$modalInstance","ResolveData"]}(),function(){function UserListThemes($scope,ThemeFactory,UserFactory,$location,$modal,$timeout,$rootScope){function callServer(tableState){$this.isLoading=!0;var pagination=tableState.pagination,start=pagination.start||0,number=pagination.number||$this.onPage;UserFactory.themes(start,number,tableState,{user_id:$this.user_id}).then(function(result){var number_to=eval(parseInt(number)+parseInt(start));$this.themes=result.data,$this.table={start:start+1,number:number_to<result.total?number_to:result.total,total:result.total},tableState.pagination.numberOfPages=result.numberOfPages,$this.isLoading=!1,$this.results=void 0!==$this.themes?!0:!1})}function deleteRow(e){var t=UserFactory.deleteFromTheme({theme:e.Theme.id,user:$this.user_id});t.then(deleteSuccess,error)}function changeActive(e,t){ThemeFactory.save({Theme:{id:t,active:1==e?1:0}})}var $this=this;$this.themes=[],$this.user_id=$scope.userId,$this.filters={},$this.isLoading=!1,$this.changeActive=changeActive,$this.loadData=callServer,$this.pages=[5,10,15],$this.onPage=5,$this.results=!0,$this.deleteRow=deleteRow;var deleteSuccess=function(e){$timeout(function(){angular.forEach($this.themes,function(t,o){t.Theme.id===e.data.theme&&($this.themes.splice(o,1),$this.loadData,$rootScope.$broadcast("removeUserFromTheme",e))})},400)},error=function(){}}angular.module("user.controllers").controller("UserListThemes",UserListThemes),UserListThemes.$inject=["$scope","ThemeFactory","UserFactory","$location","$modal","$timeout","$rootScope"]}(),function(){function e(e,t,o,n,r,a){function i(e){u.filters.role_id=e;angular.copy(u.scope_users);u.users_list=a("filter")(u.scope_users,e===!1?{}:{role_id:e})}function s(){if(e.messageForm.$valid&&u.selected.length){var t=angular.extend(u.formData,{users:u.selected});n.sendMail(u.project,t).then(function(){u.success=!0,u.formData={},e.messageForm.$setPristine()})}else e.messageForm.submitted=!0}function l(e){e.checked=e.checked?!1:!0,u.selected.push(e),u.selected=a("filter")(u.selected,{checked:!0},function(e,t){return angular.equals(e,t)}),u.checked_all=u.selected.length===u.users_list.length?!0:!1}function c(){u.checked_all=u.checked_all?!1:!0,u.selected=[],angular.forEach(u.users_list,function(e,t){u.checked_all===!0?u.selected.push(angular.extend(e,{checked:!0})):u.users_list[t].checked=!1})}var u=this;u.selected=[],u.scope_users=[],u.users_list=[],u.formData={},u.checked_all=!1,u.filters={},u.project=null,u.selectUser=l,u.selectAll=c,u.sendForm=s,u.filterUsers=i,e.$watch("users",function(e){this.scope_users=this.users_list=e}.bind(this)),e.$watch("project",function(e){this.project=e}.bind(this))}angular.module("user.controllers").controller("UsersMassmailCtrl",e),e.$inject=["$scope","$rootScope","UserFactory","ProjectFactory","$timeout","$filter"]}(),function(){"use strict";function e(e,t,o){function n(e){e.allow_create_account="live"!==o.enviroment()?!0:!1,e.newAccount=function(){r()}}function r(){t.open({controller:"newAccountModalCtrl as ctrl",templateUrl:"js/modal/templates/new-account-modal.html",size:"md"})}var a={restrict:"A",scope:{},transclude:!0,templateUrl:"js/users/directives/templates/new-account-tpl.html",link:n};return a}angular.module("user.directives").directive("newAccount",e),e.$inject=["UserFactory","$modal","BaseConst"]}(),function(){function e(e){return{restrict:"A",scope:{data:"@"},template:"{{result}}",link:function(t,o,n){var r=e.find({username:n.data});r.then(function(e){console.log(e),t.result=e})}}}angular.module("user.directives").directive("userUniq",e),e.$inject=["UserService"]}(),function(){function e(){return{scope:{comments:"="},restrict:"E",replace:!0,template:'<ul class="list-group list-group-sp"  ><comment-item comment="comment" ng-repeat="comment in comments"></comment-item></ul>',link:function(){}}}angular.module("user.directives").directive("userComments",e)}(),function(){function e(e){return{scope:{comment:"="},restrict:"E",replace:!0,templateUrl:"js/users/directives/templates/user-comment-item.html",link:function(t,o){t.hasChild=!1,t.icon_down=!0;var n='<user-comments comments="comment.children"  ></user-comments>';angular.isArray(t.comment.children)&&(t.hasChild=!0),t.openChild=function(){var r=angular.element(o).find("ul");t.icon_down=t.icon_down?!1:!0,r.length?r.remove():angular.isArray(t.comment.children)&&e(n)(t,function(e){o.append(e)})}}}}angular.module("user.directives").directive("commentItem",e),e.$inject=["$compile"]}(),function(){function e(e,t,o){function n(e,t,n){o.getUserData().then(function(e){"admin"===e.role&&t.bind("click",r.bind(this,n))
})}function r(o,n){n.preventDefault(),e.open({controller:"viewUserModalCtrl as ctrl",templateUrl:"js/modal/templates/user-detail-modal.html",size:"lg",resolve:{user:function(){return t.view({id:o.userId}).then(function(){return t.data})}}})}var a={scope:{userId:"@"},restrict:"EA",link:n};return a}function t(e,t,o,n,r,a){function i(){r.user({user_id:l.user.User.id,theme_id:l.theme_id}).then(function(){l.comments=r.data})}function s(){a.save(l.user).then(function(){},function(){l.user=o})}var l=this;l.user=o;var o=angular.copy(l.user);l.edit_name=!1,this.comments=[],this.saveUser=s,this.changeTheme=i,n.$on("removeUserFromTheme",function(e,t){a.view({id:t.data.user}).then(function(){l.user=a.data})}),e.cancel=function(){t.dismiss("cancel")}}angular.module("user.directives").directive("viewUserDetails",e).controller("viewUserModalCtrl",t),e.$inject=["$modal","UserFactory","UserService","$rootScope"],t.$inject=["$scope","$modalInstance","user","$rootScope","CommentFactory","UserFactory"]}(),function(){function e(){return{scope:{userId:"@"},restrict:"A",replace:!0,templateUrl:"js/users/directives/templates/user-list-themes.html",controller:"UserListThemes",controllerAs:"ctrl",link:function(){}}}angular.module("user.directives").directive("userListThemes",e)}(),function(){function e(e){function t(e,t,n){t.bind("click",function(e){o(n,e)})}function o(t,o){o.preventDefault(),e.open({templateUrl:"js/modal/templates/user-list-themes-modal.html",size:"lg",controller:["$scope","$modalInstance","user_id",function(e,t,o){e.user_id=o,e.cancel=function(){t.dismiss("cancel")}}],controllerAs:"ctrl",resolve:{user_id:function(){return t.userId}}})}var n={scope:{userId:"@"},restrict:"A",link:t};return n}angular.module("user.directives").directive("userListThemesModal",e),e.$inject=["$modal"]}(),function(){"use strict";function e(){var e={scope:{view:"&onView"},restrict:"A",templateUrl:"js/users/directives/templates/user-list-table.html",controller:"UsersListCtrl",controllerAs:"ctrl"};return e}angular.module("user.directives").directive("userList",e)}(),function(){"use strict";function e(){var e={scope:{users:"=",project:"="},restrict:"E",templateUrl:"js/users/directives/templates/users-massmail.html",controller:"UsersMassmailCtrl",controllerAs:"ctrl",link:function(){}};return e}angular.module("user.directives").directive("usersMassmail",e)}(),function(){function e(e,t,o,n,r){this.api=r.url,this.list=function(e){return t.get(this.api+"/comments",{params:e})},this.theme=function(e,o,n){return t.get(this.api+"/comments/theme/"+e+"/"+o,{params:n})},this.user=function(e){if(void 0===e.user_id||void 0===e.theme_id)return alert("Error Missing user_id and theme_id");var o=e.user_id,n=e.theme_id;return delete e.user_id,delete e.theme_id,t.get(this.api+"/comments/user/"+o+"/"+n,{params:e})},this.listReactions=function(e){return t.get(this.api+"/comments/getallreactions",{params:e})},this.delete=function(e){return t.get(this.api+"/comments/delete",{params:{id:e}})},this.view=function(e){return t.get(this.api+"/comments/view",{params:{id:e}})},this.save=function(e){return t.post(this.api+"/comments/save",{data:e})},this.upload=function(t,r){for(var a=[],i=e.defer(),s=0;s<t.length;s++){var l=n.upload({url:this.api+"/comments/upload",method:"POST",data:{data:r},file:t[s],fileFormDataName:"uploadFile"}).progress(function(e){o.$broadcast("onProgress",parseInt(100*e.loaded/e.total))});a.push(l)}return e.all(a).then(function(e){i.resolve(e)}),i.promise}}angular.module("theme.services").service("CommentService",e),e.$inject=["$q","$http","$rootScope","$upload","ApiConst"]}(),function(){function e(e,t,o,n,r){this.api=r.url,this.list=function(e){return t.get(this.api+"/themes",{params:e})},this.users=function(e,o){return t.get(this.api+"/themes/users/"+e,{params:o})},this.delete=function(e){return t.delete(this.api+"/themes/delete",{params:{id:e}})},this.deleteImage=function(e){return t.delete(this.api+"/themes/image",{params:e})},this.view=function(e){return t.get(this.api+"/themes/view",{params:{id:e}})},this.save=function(e){return t.post(this.api+"/themes/save",{data:e})},this.upload=function(e,t){return n.upload({url:this.api+"/themes/upload",method:"POST",withCredentials:!0,data:{data:t},file:e,fileName:"file",fileFormDataName:"file"})}}angular.module("theme.services").service("ThemeService",e),e.$inject=["$q","$http","$rootScope","$upload","ApiConst"]}(),function(){function e(e,t,o,n){this.api=n.url,this.login=function(e){return t.post(this.api+"/login",e)},this.forgot=function(e){return t.post(this.api+"/login/forgot",e)},this.logout=function(){var e=this;return t.get(this.api+"/login/logout").success(function(){e.clearUser()})},this.isAuthorized=function(){return t.post(this.api+"/auth",{token:localStorage.token})},this.clearUser=function(){localStorage.token="",localStorage.role="",localStorage.user=""}}angular.module("user.services").service("AuthService",e),e.$inject=["$q","$http","$rootScope","ApiConst"]}(),function(){function e(e,t,o,n){this.api=n.url,this.list=function(e){return t.get(this.api+"/users",{params:e})},this.themes=function(e){var o=e.user_id;return delete e.user_id,t.get(this.api+"/users/"+o+"/themes",{params:e})},this.getUserData=function(){var t=this;if(localStorage.user&&"undefined"!==localStorage.user){var o=e.defer();return o.resolve({user:JSON.parse(localStorage.user),role:localStorage.role}),o.promise}return t.find().then(function(e){return localStorage.setItem("user",JSON.stringify(e.data.User)),localStorage.setItem("role",e.data.Role.name),{user:e.data.User,role:e.data.Role.name}})},this.notInTheme=function(e){return t.get(this.api+"/themes/users/exclude/"+e)},this.roles=function(){return t.get(this.api+"/users/roles")},this.find=function(e){return t.get(this.api+"/users/view",{params:e})},this.validate=function(e){return t.get(this.api+"/users/valid",{params:e})},this.save=function(e){return t.post(this.api+"/users/save",{data:e})},this.register=function(e){return t.post(this.api+"/login/register",{data:e})},this.passwordSave=function(e){return t.post(this.api+"/users/password.json",{data:e})},this.delete=function(e){return t.delete(this.api+"/users/delete",{params:{id:e}})},this.deleteFromProject=function(e){return t.post(this.api+"/users/deleteproject/",e)},this.deleteFromTheme=function(e){return t.post(this.api+"/users/deleteFromTheme/",e)},this.sendMail=function(e){return t.post(this.api+"/users/mail/",e)}}angular.module("user.services").service("UserService",e),e.$inject=["$q","$http","$rootScope","ApiConst"]}(),function(){function e(e){function t(t){var n=new FileReader,r=e.defer(),a=[];return n.readAsText(t),n.onerror=o,n.onload=function(t){var o=t.target.result,n=o.split(/\r\n|\n/);e.all(n.map(function(e){var t=e.split(";"),o=Math.floor(1e7*Math.random()+1e6);a.push({id:o,name:t[0]+" "+t[1],username:t[2],imported:!0}),r.resolve(a)}))},r.promise}function o(e){"NotReadableError"==e.target.error.name&&alert("Canno't read file !")}var n={readFile:t};return n}angular.module("user.factories").factory("ReadUserFile",e),e.$inject=["$q","$http","$rootScope","UserService"]}(),function(){function e(e,t){function o(e,o,n,r){var a=n.search.predicateObject?n.search.predicateObject:{},n=angular.extend({limit:o,offset:e},a,r);return t.list(n).then(function(e){return p.data=e.data.rows,p.total=e.data.total,{data:p.data,total:p.total,numberOfPages:Math.ceil(p.total/o)}})}function n(e,o,n,r){var a=n.search.predicateObject?n.search.predicateObject:{},n=angular.extend({limit:o,offset:e},a,r);return t.themes(n).then(function(e){return p.data=e.data.rows,p.total=e.data.total,{data:p.data,total:p.total,numberOfPages:Math.ceil(p.total/o)}})}function r(e){return t.passwordSave(e)}function a(e){return t.save(e)}function i(e){return t.register(e)}function s(e){return t.delete(e)}function l(e){return t.list(e).then(function(e){p.data=e.data.rows})}function c(){return t.roles().then(function(e){e.data.rows.unshift({Role:{id:null,text:"ALL"}}),p.roles=e.data.rows})}function u(e){return t.validate(e).then(function(e){p.data=e.data})}function m(e){return t.find(e).then(function(e){p.data=e.data})}function d(e){return t.forgot(e)}function f(e){return t.deleteFromProject(e)}function h(e){return t.deleteFromTheme(e)}var p={data:[],roles:[],total:0,changePassword:r,save:a,"delete":s,register:i,list:l,getRoles:c,view:m,validate:u,forgot:d,deleteFromProject:f,deleteFromTheme:h,getPage:o,themes:n};return p}angular.module("user.factories").factory("UserFactory",e),e.$inject=["$http","UserService"]}(),function(){function e(e,t){function o(o){t.open({templateUrl:"js/modal/templates/user-modal-factory.html",controller:"UserListModalCtrl",size:"lg",resolve:{ResolveData:function(){return e.list(o.data).then(function(){var t=JSON.stringify(o.data).match(/(\w+_(id))/);return o.type?{users:e.data,id:o.data[t[0]],type:o.type}:alert("missing data type")})}}})}var n={open:o};return n}angular.module("user.factories").factory("UserModalFactory",e),e.$inject=["UserFactory","$modal"]}(),function(){function e(e,t,o,n,r,a,i,s,l,c,u,m){var d=this;d.user={},d.project={},d.open_notification=!1,o.$on("userCommentReact:load",function(e,t){n(function(){d.userCommentReact=t.length,d.open_notification=!0},300)}),a.getUserData().then(function(e){d.user=e.user,0==d.user.agreed&&"user"===localStorage.role&&/^demo/.test(window.location.host)===!1&&m.open({templateUrl:"js/modal/templates/terms-modal.html",backdrop:"static",size:"lg",controller:["$scope","$modalInstance",function(e,o){e.ok=function(){c.save({User:{agreed:1},show_message:!1}).then(function(e){localStorage.setItem("user",JSON.stringify(e.data.data.User)),o.dismiss("cancel")})},e.cancel=function(){r.logout().then(function(){o.dismiss("cancel"),t.path("/")})}}]})}),("user"===localStorage.role||"client"===localStorage.role)&&i.getList({active:1,_recursive:-1}).then(function(){void 0!==i.data.Project&&(d.project=i.data.Project,i.themes(i.data.Project.id,{active:1}).then(function(){d.themes=i.data}))}),/admin|user/.test(localStorage.role)&&s.getList({limit:5}).then(function(){d.comments=s.data}),this.reloadComments=function(e){e.preventDefault(),o.$broadcast("userCommentReact:reload")}}angular.module("home.controllers").controller("HomeController",e),e.$inject=["$scope","$location","$rootScope","$timeout","AuthService","UserService","ProjectFactory","CommentFactory","ThemeFactory","UserFactory","$log","$modal","$state"]}();